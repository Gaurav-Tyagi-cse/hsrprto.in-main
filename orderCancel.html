<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="/dashboard/assets/media/logos/Favicon.png" />
	<title>Book Your High-Security Number Plate</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9799370626617756"
     crossorigin="anonymous"></script>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet">
	<!-- Select2 Bootstrap4 Theme CSS -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-theme/0.1.0-beta.10/select2-bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/frontend/css/style.css">
</head>
<body>
	<header class="header-1">
		<nav class="navbar navbar-expand-lg ">
		  <div class="container-fluid">
		    <a class="navbar-brand" href="/"><img src="/frontend/images/logo.svg" class="img-fluid"></a>
		    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
		      <span class="navbar-toggler-icon"></span>
		    </button>
		    <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
		      <ul class="navbar-nav ">
		        <li class="nav-item">
		          <a class="nav-link active" aria-current="page" href="/orderTracking">Track Your Order</a>
		        </li>
		        <!-- <li class="nav-item">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <link rel="shortcut icon" href="/frontend/images/fav.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/frontend/css/style.css" />
  </head>
  <body>
    <header class="header-1">
      <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
          <a class="navbar-brand" href="/"
            ><img src="/frontend/images/logo.svg" class="img-fluid"
          /></a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div
            class="collapse navbar-collapse justify-content-end"
            id="navbarNavDropdown"
          >
            <ul class="navbar-nav">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  aria-current="page"
                  href="/orderTracking"
                  >Track Your Order</a
                >
              </li>
              <li class="nav-item">
		          <a class="nav-link" href="/reAppointment">Reschedule Appointment</a>
		        </li> -->
              <li class="nav-item">
                <a class="nav-link" href="/orderCancel">Cancel Order</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" href="/downloadReceipt">Reprint Receipt</a>
              </li>
              <!-- <li class="nav-item dropdown">
		           <a class="nav-link" href="/receiptValidity">Receipt Validity</a>		          
		        </li> -->
              <li class="nav-item dropdown">
                <a class="nav-link" href="/contactUs">Contact Us</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
<style>
.select2:after {
    content: "";
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    border-top: 5px solid #333;
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
}
.error {
    color: #DC3545;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: normal;
    margin-top: 8px;
    position: relative;
    top: 4px;
}
input.fieldrequired, select.fieldrequired {
    border-color: #DC3545;
}
</style>

<style>
  .error {
    color: rgb(250, 15, 15);
  }
  .step1_err,
  .step2_err,
  .step3_err {
    display: none;
  }
</style>
<section class="order-track-main page-len">
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-md-12 col-xl-8">
        <div class="order-track-head">
          <h2>Order Cancellation & Refund</h2>
          <p>
            To cancel your order and request a refund, please enter your order
            details in the fields below.
          </p>
        </div>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-sm-8 col-md-6 col-lg-5 col-xl-4">
        <div class="order-track-sec">
          <form>
            <label>Order Number: *</label>
            <input
              type="text"
              name=""
              id="orderNo"
              placeholder="DLHSRP1221XXXXXX"
              class="formdatas"
            />
            <span class="error step1_err orderNo_err"> Please Enter Order No</span>
            <label
              >Vehicle Reg No: *
              </label
            >
            <input
              type="text"
              name=""
              id="vehicleRegNo"
              placeholder="DL01ABXXXX"
              class="formdatas"
            />
            <span class="error step1_err vehicleRegNo_err">
              (Reg No. Ex.- DLXXXXX01)</span
            >
            <a class="trackorderbtn" name="Search" href="javascript:void(0)"
              >Cancel Order</a
            >
            <!-- <a class="trackorderbtn"
              name="Search"
              data-bs-toggle="modal"
              data-bs-target="#exampleModal"
              >Search</a
            > -->
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<div
  class="modal fade"
  id="exampleModal1"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          Order Cancellation & Refund
        </h5>
      </div>
      <div class="modal-body">
        <div class="modal-form">
          <div class="row">
            <div class="col-md-6">
              <h4>Order Number</h4>
              <p class="orderNo_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Vehicle Reg No</h4>
              <p class="vehicleregno_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Vehicle Type</h4>
              <p class="vehicletype_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Service Type</h4>
              <p class="serviceType_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Customer Name</h4>
              <p class="customername_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Email Address</h4>
              <p class="emailAddress_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Mobile No</h4>
              <p class="mobileNo_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Order Status</h4>
              <p class="orderStatus_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Payment Status</h4>
              <p class="paymentStatus_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Transaction Id</h4>
              <p class="transactionId_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Order At</h4>
              <p class="createAt_text"></p>
            </div>
            <div class="col-md-6">
              <h4>Delivery Address</h4>
              <p class="billingAddress_text"></p>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary resend"
          data-bs-dismiss="modal"
        >
          Close
        </button>

        <a href="#" class="btn btn-primary submit-btn downloadlink">
          Download Receipt
        </a>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<footer>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<div class="footer-list">
					<ul>
						<li><a href="/faq">FAQ</a></li>
						<li><a href="/privacyPolicy">Privacy Policy</a></li>
						<li><a href="/refundCancellation">Refund & Cancellation Policy</a></li>
						<li><a href="/safeSecureTransactions">Safe & Secure Transaction</a></li>
						<li><a href="/termsConditions">Terms & Conditions</a></li>
						<li><a href="/governmentNotifications">Government Notifications</a></li>
						<li><a href="/aboutUs">About HSRP</a></li>
						<!-- <li><a href="/grievanceRedressal">Grievance Redressal</a></li> -->
						<li><a href="/downloadReceipt">Reprint Receipt</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</footer>
<script>
$(document).ready(function() {
	$('.select2').select2({
		theme: 'bootstrap4',
		allowClear: true,
		tags: true,
	});
});
</script>
</body>
</html>
<script src="/frontend/js/axios.min.js"></script>
<script>
  $(document).ready(function () {
    hideErrorOnInput("#orderNo", ".orderNo_err");
    hideErrorOnInput("#vehicleRegNo", ".vehicleRegNo_err");

    function hideErrorOnInput(fieldId, errorClass) {
      $(fieldId).on("input change", function () {
        $(errorClass).hide(); // Hide the error message
      });
    }

    $(".trackorderbtn").on("click", function (e) {
      e.preventDefault(); // Prevent default form submission

      // Reset error messages
      let isValid = true;
      let firstInvalidField = null;
      $(".error").hide(); // Hide all errors initially
      $('.formdatas').removeClass('fieldrequired');

      // Fields to validate (Step 1)
      const step1Fields = [
        { id: "#orderNo", errorClass: ".orderNo_err", invalidValue: "" },
        {
          id: "#vehicleRegNo",
          errorClass: ".vehicleRegNo_err",
          invalidValue: "",
        },
      ];

      // Validate each field and display errors (Step 1)
      $.each(step1Fields, function (index, field) {
        const fieldValue = $(field.id).val().trim();

        if (fieldValue === field.invalidValue) {
          $(field.errorClass).show();
          $(field.id).addClass('fieldrequired');
          isValid = false;
          if (!firstInvalidField) {
            firstInvalidField = $(field.id);
          }
        }else {
            $(field.id).removeClass('fieldrequired');
        }
      });

      // Focus on the first invalid field
      if (firstInvalidField) {
        firstInvalidField.focus();
      }
      // Show next step if all fields are valid
      if (isValid) {
        const data = {
          orderNo: $("#orderNo").val(),
          vehicleRegNo: $("#vehicleRegNo").val(),
        };
        axios
          .put("/order/cancel", data, {
            headers: {
              "Content-Type": "application/json",
              accept: "*/*",
            },
          })
          .then((response) => {
            const orderdetail = response.data.data;
            $(".orderNo_text").html(orderdetail.orderNo);
            $(".vehicleregno_text").html(orderdetail.vehicleRegNo);
            $(".vehicletype_text").html(orderdetail.vehicleTypeText);
            $(".serviceType_text").html(orderdetail.serviceText);
            $(".customername_text").html(orderdetail.customerName);
            $(".emailAddress_text").html(orderdetail.emailAddress);
            $(".mobileNo_text").html(orderdetail.mobileNo);
            $(".orderStatus_text").html(orderdetail.orderStatusText);
            $(".paymentStatus_text").html(orderdetail.paymentStatusText);
            $(".transactionId_text").html(orderdetail.transactionId);
            $(".billingAddress_text").html(orderdetail.billingAddress);
            $(".downloadlink").attr(
              "href",
              "/pdfVoucher/" + btoa(orderdetail.orderId)
            );
            const orderdatetext = new Date(orderdetail.createdAt);
            const options = {
              day: "numeric",
              month: "short",
              year: "numeric",
              hour: "numeric",
              minute: "2-digit",
              second: "2-digit",
              hour12: true,
            };
            const orderdate = orderdatetext
              .toLocaleString("en-US", options)
              .replace(",", "");
            $(".createAt_text").html(orderdate);

            $("#exampleModal1").modal("show");
          })
          .catch((error) => {
            Swal.fire({ text: error.response.data.message, icon: "error", buttonsStyling: !1, confirmButtonText: "Ok, got it!", customClass: { confirmButton: "btn btn-primary" } });
          });
      }
    });
  });
</script>
